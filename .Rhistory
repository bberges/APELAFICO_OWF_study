strip.background = element_blank(),
strip.placement = "outside")
ggsave(file.path(figurePath,'pub',paste0('Fig2.png')),
p,
width = 170,
height = 120,
units = c("mm"),
dpi = 300)
############################################################################
# Fig 3
############################################################################
# format CPOD table
#df.plot.CPOD.dayNight <- subset(CPOD.all.hour,!(dataSet == '2021-BE' & pairing == 2))
df.plot.CPOD.dayNight <- CPOD.all.hour
df.plot.CPOD.dayNight$time_day <- as.POSIXct(cut(df.plot.CPOD.dayNight$time_hour, breaks = "1 day"),tz='UTC')
df.plot.CPOD.dayNight <- df.plot.CPOD.dayNight %>% group_by(time_day,stationName,dataSet,type,pairing,dayNight) %>%
summarize(pres.ratio=length(which(is.na(all)))/n())
df.plot.CPOD.dayNight$date <- NA
df.plot.CPOD.dayNight$date[df.plot.CPOD.dayNight$dataSet == '2021-BE'] <- 'July-Aug 21'
df.plot.CPOD.dayNight$date[df.plot.CPOD.dayNight$dataSet == '2023-BSW'] <- 'May-June 23'
df.plot.CPOD.dayNight$date[df.plot.CPOD.dayNight$dataSet == '2023-BE'] <- 'July-Sep 23'
df.plot.CPOD.dayNight$date[df.plot.CPOD.dayNight$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.plot.CPOD.dayNight$date <- factor(df.plot.CPOD.dayNight$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.plot.CPOD.dayNight$pairingName <- NA
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2021-BE' & df.plot.CPOD.dayNight$pairing == 1] <- 'Birk-/Belw-'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2021-BE' & df.plot.CPOD.dayNight$pairing == 2] <- 'Graf-/Cpow-'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2023-BSW' & df.plot.CPOD.dayNight$pairing == 1] <- 'BSW far 1/4'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2023-BSW' & df.plot.CPOD.dayNight$pairing == 2] <- 'BSW near 2/3'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2023-BE' & df.plot.CPOD.dayNight$pairing == 1] <- 'Gard-/Belw-'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2023-BE' & df.plot.CPOD.dayNight$pairing == 2] <- 'Graf-/Cpow-'
df.plot.CPOD.dayNight$pairingName[df.plot.CPOD.dayNight$dataSet == '2024-BE' & df.plot.CPOD.dayNight$pairing == 1] <- 'Graf-/Cpow-'
df.plot.CPOD.dayNight$time <- paste0('CPOD-',as.character(df.plot.CPOD.dayNight$time_day))
# format WBAT table
df.plot.WBAT.dayNight <- subset(WBAT.pairwise,frequency == 70)
#df.plot.WBAT.dayNight <- subset(df.plot.WBAT.dayNight,!(dataSet == '2021-BE' & pairing == 2))
df.plot.WBAT.dayNight$date <- NA
df.plot.WBAT.dayNight$date[df.plot.WBAT.dayNight$dataSet == '2021-BE'] <- 'July-Aug 21'
df.plot.WBAT.dayNight$date[df.plot.WBAT.dayNight$dataSet == '2023-BSW'] <- 'May-June 23'
df.plot.WBAT.dayNight$date[df.plot.WBAT.dayNight$dataSet == '2023-BE'] <- 'July-Sep 23'
df.plot.WBAT.dayNight$date[df.plot.WBAT.dayNight$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.plot.WBAT.dayNight$date <- factor(df.plot.WBAT.dayNight$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.plot.WBAT.dayNight$type <- factor(df.plot.WBAT.dayNight$type,levels = c('control','OWF'))
df.plot.WBAT.dayNight$pairingName <- NA
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2021-BE' & df.plot.WBAT.dayNight$pairing == 1] <- 'Birk-/Belw-'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2021-BE' & df.plot.WBAT.dayNight$pairing == 2] <- 'Graf-/Cpow-'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2023-BSW' & df.plot.WBAT.dayNight$pairing == 1] <- 'BSW far 1/4'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2023-BSW' & df.plot.WBAT.dayNight$pairing == 2] <- 'BSW near 2/3'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2023-BE' & df.plot.WBAT.dayNight$pairing == 1] <- 'Gard-/Belw-'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2023-BE' & df.plot.WBAT.dayNight$pairing == 2] <- 'Graf-/Cpow-'
df.plot.WBAT.dayNight$pairingName[df.plot.WBAT.dayNight$dataSet == '2024-BE' & df.plot.WBAT.dayNight$pairing == 1] <- 'Graf-/Cpow-'
df.plot.WBAT.dayNight$time <- paste0('WBAT-',as.character(df.plot.WBAT.dayNight$time_hour))
# join tables
df1 <- df.plot.CPOD.dayNight %>% ungroup %>% select(c('time','pairingName','type','pres.ratio','date','dayNight'))
df2 <- df.plot.WBAT.dayNight %>% ungroup %>% select(c('time','pairingName','type','SA','date','dayNight'))
df2$SA <- log10(df2$SA)
df.plot.dayNight <- full_join(df1,df2,by=c('time','pairingName','type','date','dayNight'))
df.plot.dayNight <- df.plot.dayNight %>% pivot_longer(!time & !pairingName & !type & !date & !dayNight,names_to = 'metric',values_to = 'val')
# df.plot$metric[df.plot$metric == "SA"] <- bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')')
# df.plot$metric[df.plot$metric == "pres.ratio"] <- "HP daily presence (%)"
#df.plot$metric <- factor(df.plot$metric,levels = c("log10(SA) (dB re 1 m^2 m^-2 h)","HP daily presence (%)"))
df.plot.dayNight$metric <- factor(df.plot.dayNight$metric,levels = c("SA","pres.ratio"))
df.plot.dayNight$pairingName[df.plot.dayNight$pairingName == "Graf-/Cpow-" & df.plot.dayNight$date == 'July-Aug 21'] <- "Graf-/Cpow- Jul21"
df.plot.dayNight$pairingName[df.plot.dayNight$pairingName == "Graf-/Cpow-" & df.plot.dayNight$date == 'July-Sep 23'] <- "Graf-/Cpow- Jul23"
df.plot.dayNight$pairingName[df.plot.dayNight$pairingName == "Graf-/Cpow-" & df.plot.dayNight$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.plot.dayNight$typePair <- paste0(df.plot.dayNight$type,'-',df.plot.dayNight$pairingName)
p <- ggplot(df.plot.dayNight,aes(x=dayNight,y=val,col=type,group = typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab('')+
facet_wrap(~metric,scales = 'free',
strip.position = "left")+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom",
strip.background = element_blank(),
strip.placement = "outside")
ggsave(file.path(figurePath,'pub',paste0('Fig3.png')),
p,
width = 170,
height = 120,
units = c("mm"),
dpi = 300)
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$treshold
unique(df.all$treshold)
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
!is.na(df.all$pairingName)
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
ggplot(df.all,aes(x=HP,y=log10(SA),col=type,group=typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab(bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')'))+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom")
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
subset(df.all,(dataSet == '2021-BE' & pairing == 2))
ggplot(df.all,aes(x=HP,y=log10(SA),col=type,group=typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab(bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')'))+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom")
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
#df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
ggplot(df.all,aes(x=HP,y=log10(SA),col=type,group=typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab(bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')'))+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom")
df.all$typePair
unique(df.all$typePair)
length(unique(df.all$typePair))
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
#df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
length(unique(df.all$typePair))
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'July-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'July-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('July-Aug 21',
'May-June 23',
'July-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
#df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
length(unique(df.all$typePair))
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21']
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'Jul-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'Jul-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('Jul-Aug 21',
'May-June 23',
'Jul-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
#df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
length(unique(df.all$typePair))
ggplot(df.all,aes(x=HP,y=log10(SA),col=type,group=typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab(bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')'))+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom")
df.all <- left_join(subset(WBAT.pairwise,frequency == 70),
CPOD.all.hour,by=c('stationSet',
'type',
'dataSet',
'pairing',
'time_hour',
'dayNight'))
#subset(df.all,(dataSet == '2021-BE' & pairing == 2))
df.all$HP.bool <- 1
df.all$HP.bool[is.na(df.all$all)] <- 0
df.all$HP <- 'HP present'
df.all$HP[is.na(df.all$all)] <- 'No HP'
h1 <- hist(df.all$pos_minutes)
df.all <- df.all %>% mutate(bin = cut(pos_minutes, breaks = h1$breaks, labels = h1$mids),
bin_inter = cut(pos_minutes, breaks = h1$breaks))
df.all$type <- factor(df.all$type,levels = c('control','OWF'))
df.all$date <- NA
df.all$date[df.all$dataSet == '2021-BE'] <- 'Jul-Aug 21'
df.all$date[df.all$dataSet == '2023-BSW'] <- 'May-June 23'
df.all$date[df.all$dataSet == '2023-BE'] <- 'Jul-Sep 23'
df.all$date[df.all$dataSet == '2024-BE'] <- 'Oct-Dec 23'
df.all$date <- factor(df.all$date,level=c('Jul-Aug 21',
'May-June 23',
'Jul-Sep 23',
'Oct-Dec 23'))
df.all$pairingName <- NA
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 1] <- 'Birk-/Belw-'
df.all$pairingName[df.all$dataSet == '2021-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 1] <- 'BSW far 1/4'
df.all$pairingName[df.all$dataSet == '2023-BSW' & df.all$pairing == 2] <- 'BSW near 2/3'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 1] <- 'Gard-/Belw-'
df.all$pairingName[df.all$dataSet == '2023-BE' & df.all$pairing == 2] <- 'Graf-/Cpow-'
df.all$pairingName[df.all$dataSet == '2024-BE' & df.all$pairing == 1] <- 'Graf-/Cpow-'
#df.all <- df.all[!is.na(df.all$pairingName),]
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Aug 21'] <- "Graf-/Cpow- Jul21"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Jul-Sep 23'] <- "Graf-/Cpow- Jul23"
df.all$pairingName[df.all$pairingName == "Graf-/Cpow-" & df.all$date == 'Oct-Dec 23'] <- "Graf-/Cpow- Oct23"
df.all$typePair <- paste0(df.all$type,'-',df.all$pairingName)
length(unique(df.all$typePair))
p <- ggplot(df.all,aes(x=HP,y=log10(SA),col=type,group=typePair))+
theme_bw()+
stat_summary(fun.data=mean_se, geom="pointrange", na.rm = TRUE,alpha=0.5)+
stat_summary(fun.y=mean, geom="line")+
xlab('')+
ylab(bquote(.('Area backscattering coefficient (dB re 1 ')  ~ m^2 ~ m^-2 ~ h~')'))+
guides(col=guide_legend(title=""))+
theme(legend.position="bottom")
ggsave(file.path(figurePath,'pub',paste0('Fig4.png')),
p,
width = 100,
height = 120,
units = c("mm"),
dpi = 300)
